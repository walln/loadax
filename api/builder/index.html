
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../roadmap/">
      
      
        <link rel="next" href="../loader/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Dataloader Builder - Loadax Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dataloaderbuilder" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            


          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Loadax Documentation" class="md-header__button md-logo" aria-label="Loadax Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Loadax Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Dataloader Builder
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/walln/loadax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    walln/loadax
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  API Documentation

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Loadax Documentation" class="md-nav__button md-logo" aria-label="Loadax Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Loadax Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/walln/loadax" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    walln/loadax
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Loadax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multi-host/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-Host Training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Dataloader
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Dataloader
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Dataloader Builder
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Dataloader Builder
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      DataloaderBuilder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.workers" class="md-nav__link">
    <span class="md-ellipsis">
      workers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      prefetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.shard" class="md-nav__link">
    <span class="md-ellipsis">
      shard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../naive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Naive Dataloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utilties
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            Utilties
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../progress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Progress
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Batching Strategies
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Batching Strategies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../strategy/batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Batch Strategy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../strategy/fixed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fixed Batch Strategy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Sharding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Sharding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharding/sharding-strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharding Strategy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sharding/presets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Presets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/dataset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/in-memory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    InMemoryDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/range/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RangeDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4_4" id="__nav_2_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transformations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4_4">
            <span class="md-nav__icon md-icon"></span>
            Transformations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/transformations/mapped/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MappedDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/transformations/combined/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CombinedDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/transformations/partial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PartialDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/transformations/sampled/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SampledDataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/transformations/shuffled/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ShuffledDataset
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      DataloaderBuilder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.workers" class="md-nav__link">
    <span class="md-ellipsis">
      workers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.prefetch" class="md-nav__link">
    <span class="md-ellipsis">
      prefetch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.shard" class="md-nav__link">
    <span class="md-ellipsis">
      shard
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#loadax.DataloaderBuilder.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<h1 id="dataloaderbuilder">DataloaderBuilder<a class="headerlink" href="#dataloaderbuilder" title="Permanent link">&para;</a></h1>
<p>Most of the time, you just want to create a dataloader, set a few options, and be done with it. The <code>DataloaderBuilder</code> is a convenient way to do this. It is a fluent builder that allows you to chain together methods to create a dataloader instead of configuring each option individually.</p>
<div class="language-python highlight"><span class="filename">Creating a dataloader</span><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span><span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>


<div class="doc doc-object doc-class">



<a id="loadax.DataloaderBuilder"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code></p>


        <p>A dataloader is a primitive for efficiently loading data from a dataset.</p>
<p>A dataloader is effectively a smart iterator that optimizes getting data from the
dataset. The dataloader is responsible for ensuring the data is batched, ready
when it is needed, and loaded into mmemory in a way that is efficient. All of this
should be done without hijacking the main thread and preventing you from doing the
important parts of your training loop.</p>
<p>The dataloader is built by chaining methods on the <code>DataLoader</code> class. The
methods are designed to be chained in a fluent style, allowing you to build
a dataloader with the desired configuration.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span><span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.batcher">batcher</span></code></td>
            <td>
                  <code><span title="loadax.batcher.Batcher">Batcher</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batcher to use for batching.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.strategy">strategy</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.strategy.BatchStrategy" href="../strategy/batch/#loadax.strategy.BatchStrategy">BatchStrategy</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch strategy to use for computing batches.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.num_workers">num_workers</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of workers to use for parallel data loading.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.prefetch_factor">prefetch_factor</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefetch factor to use for prefetching.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.sharding_strategy">sharding_strategy</span></code></td>
            <td>
                  <code>JaxShardingStrategy</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sharding strategy to use for
distributed data loading.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.shard_id">shard_id</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the shard to load the data from.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="loadax.DataloaderBuilder.num_shards">num_shards</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shards to distribute the data across.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

        <p>A dataloader is effectively a smart iterator that optimizes getting data from
the dataset. The dataloader is responsible for ensuring the data is batched,
ready when it is needed, and loaded into mmemory in a way that is efficient.
All of this should be done without hijacking the main thread and preventing you
from doing the important parts of your training loop.</p>
<p>The dataloader is built by chaining methods on the <code>DataLoader</code> class. The
methods are designed to be chained in a fluent style, allowing you to build
a dataloader with the desired configuration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batcher</code></td>
            <td>
                  <code><span title="loadax.batcher.Batcher">Batcher</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batcher to use for batching.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

                  <details class="quote">
                    <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batcher</span><span class="p">:</span> <span class="n">Batcher</span><span class="p">[</span><span class="n">DatasetItem</span><span class="p">,</span> <span class="n">Batch</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dataloader is a primitive for efficiently loading data from a dataset.</span>

<span class="sd">    A dataloader is effectively a smart iterator that optimizes getting data from</span>
<span class="sd">    the dataset. The dataloader is responsible for ensuring the data is batched,</span>
<span class="sd">    ready when it is needed, and loaded into mmemory in a way that is efficient.</span>
<span class="sd">    All of this should be done without hijacking the main thread and preventing you</span>
<span class="sd">    from doing the important parts of your training loop.</span>

<span class="sd">    The dataloader is built by chaining methods on the `DataLoader` class. The</span>
<span class="sd">    methods are designed to be chained in a fluent style, allowing you to build</span>
<span class="sd">    a dataloader with the desired configuration.</span>

<span class="sd">    Args:</span>
<span class="sd">        batcher (Batcher): The batcher to use for batching.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batcher</span> <span class="o">=</span> <span class="n">batcher</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="loadax.DataloaderBuilder.batch_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">batch_size</span>


<a href="#loadax.DataloaderBuilder.batch_size" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">batch_size</span><span class="p">(</span><span class="n">batch_size</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">,</span> <span class="n"><span title="loadax.dataloader.builder.Batch">Batch</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the batch size for the dataloader.</p>
<p>This method sets the batch size for the dataloader. The batch size is the
number of items to include in a batch. The batch size should be a multiple
of the number of workers, otherwise the dataloader will not be able to
prefetch batches efficiently.</p>
<p>Currently, the dataloader only supports fixed batch sizes. This means that
with the exception of the last batch, all other batches will have the same
size. This may change in the future with the introduction of dynamic batch
sizes.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span><span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>batch_size</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The batch size to use for the dataloader.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataloader</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataloader with the batch size set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">batch_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataloaderBuilder[DatasetItem, Batch]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the batch size for the dataloader.</span>

<span class="sd">    This method sets the batch size for the dataloader. The batch size is the</span>
<span class="sd">    number of items to include in a batch. The batch size should be a multiple</span>
<span class="sd">    of the number of workers, otherwise the dataloader will not be able to</span>
<span class="sd">    prefetch batches efficiently.</span>

<span class="sd">    Currently, the dataloader only supports fixed batch sizes. This means that</span>
<span class="sd">    with the exception of the last batch, all other batches will have the same</span>
<span class="sd">    size. This may change in the future with the introduction of dynamic batch</span>
<span class="sd">    sizes.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from loadax import DataloaderBuilder, InMemoryDataset, Batcher</span>

<span class="sd">        dataset = InMemoryDataset([1, 2, 3, 4, 5])</span>
<span class="sd">        batcher = Batcher(lambda x: x)</span>
<span class="sd">        dataloader = DataloaderBuilder(batcher).batch_size(2).build(dataset)</span>
<span class="sd">        iterator = iter(dataloader)</span>
<span class="sd">        for batch in iterator:</span>
<span class="sd">            print(batch)</span>

<span class="sd">        #&gt; [1, 2]</span>
<span class="sd">        #&gt; [3, 4]</span>
<span class="sd">        #&gt; [5]</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        batch_size (int): The batch size to use for the dataloader.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataloader: The dataloader with the batch size set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span> <span class="o">=</span> <span class="n">FixedBatchStrategy</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="loadax.DataloaderBuilder.workers" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">workers</span>


<a href="#loadax.DataloaderBuilder.workers" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">workers</span><span class="p">(</span><span class="n">num_workers</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">,</span> <span class="n"><span title="loadax.dataloader.builder.Batch">Batch</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the number of workers for the dataloader.</p>
<p>This method sets the number of workers for the dataloader. The number of
workers determines the number of parallel threads that will be used to
load data. The number of workers should be a multiple of the batch size,
otherwise the dataloader will not be able to prefetch batches efficiently.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span><span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">workers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>num_workers</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of workers to use for the dataloader.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataloader</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataloader with the number of workers set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">workers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataloaderBuilder[DatasetItem, Batch]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the number of workers for the dataloader.</span>

<span class="sd">    This method sets the number of workers for the dataloader. The number of</span>
<span class="sd">    workers determines the number of parallel threads that will be used to</span>
<span class="sd">    load data. The number of workers should be a multiple of the batch size,</span>
<span class="sd">    otherwise the dataloader will not be able to prefetch batches efficiently.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from loadax import DataloaderBuilder, InMemoryDataset, Batcher</span>

<span class="sd">        dataset = InMemoryDataset([1, 2, 3, 4, 5])</span>
<span class="sd">        batcher = Batcher(lambda x: x)</span>
<span class="sd">        dataloader = DataloaderBuilder(batcher).batch_size(2).workers(2).build(dataset)</span>
<span class="sd">        iterator = iter(dataloader)</span>
<span class="sd">        for batch in iterator:</span>
<span class="sd">            print(batch)</span>

<span class="sd">        #&gt; [1, 2]</span>
<span class="sd">        #&gt; [3, 4]</span>
<span class="sd">        #&gt; [5]</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        num_workers (int): The number of workers to use for the dataloader.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataloader: The dataloader with the number of workers set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="n">num_workers</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="loadax.DataloaderBuilder.prefetch" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prefetch</span>


<a href="#loadax.DataloaderBuilder.prefetch" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">prefetch</span><span class="p">(</span><span class="n">factor</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">,</span> <span class="n"><span title="loadax.dataloader.builder.Batch">Batch</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the prefetch factor for the dataloader.</p>
<p>This method sets the prefetch factor for the dataloader. The prefetch
factor determines the number of batches to prefetch ahead of time. The
prefetch factor is a multiplier and should be a multiple of the number
of workers, otherwise the dataloader will not be able to prefetch batches
efficiently.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span>
                <span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>factor</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefetch factor to use for the dataloader.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataloader</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataloader with the prefetch factor set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prefetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataloaderBuilder[DatasetItem, Batch]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the prefetch factor for the dataloader.</span>

<span class="sd">    This method sets the prefetch factor for the dataloader. The prefetch</span>
<span class="sd">    factor determines the number of batches to prefetch ahead of time. The</span>
<span class="sd">    prefetch factor is a multiplier and should be a multiple of the number</span>
<span class="sd">    of workers, otherwise the dataloader will not be able to prefetch batches</span>
<span class="sd">    efficiently.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from loadax import DataloaderBuilder, InMemoryDataset, Batcher</span>

<span class="sd">        dataset = InMemoryDataset([1, 2, 3, 4, 5])</span>
<span class="sd">        batcher = Batcher(lambda x: x)</span>
<span class="sd">        dataloader = DataloaderBuilder(batcher)</span>
<span class="sd">                        .batch_size(2)</span>
<span class="sd">                        .prefetch(2)</span>
<span class="sd">                        .build(dataset)</span>
<span class="sd">        iterator = iter(dataloader)</span>
<span class="sd">        for batch in iterator:</span>
<span class="sd">            print(batch)</span>

<span class="sd">        #&gt; [1, 2]</span>
<span class="sd">        #&gt; [3, 4]</span>
<span class="sd">        #&gt; [5]</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        factor (int): The prefetch factor to use for the dataloader.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataloader: The dataloader with the prefetch factor set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prefetch_factor</span> <span class="o">=</span> <span class="n">factor</span> <span class="k">if</span> <span class="n">factor</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="loadax.DataloaderBuilder.shard" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">shard</span>


<a href="#loadax.DataloaderBuilder.shard" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">shard</span><span class="p">(</span><span class="n">mesh</span><span class="p">:</span> <span class="n"><span title="jax.sharding.Mesh">Mesh</span></span><span class="p">,</span> <span class="n">data_axis_name</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_shards</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">shard_id</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">,</span> <span class="n"><span title="loadax.dataloader.builder.Batch">Batch</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the mesh and partition spec for the dataloader.</p>
<p>This will distribute the dataloading across multiple nodes within the same
distributed network. This is useful for training large models on multiple
nodes. You can then load the data into multiple devices on each node and
train the model in parallel.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">shard</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">data_axis_name</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mesh</code></td>
            <td>
                  <code><span title="jax.sharding.Mesh">Mesh</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mesh to use for sharding.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>data_axis_name</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the data axis to use for sharding.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>num_shards</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of shards to distribute the data across.
If not specified, the dataloader will choose automatically using
jax.process_count().</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shard_id</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the shard to load the data from.
If not specified, the dataloader will choose automatically using
jax.process_index().</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataloader</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataloader.builder.DataloaderBuilder" href="#loadax.DataloaderBuilder">DataloaderBuilder</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataloader with the mesh and partition spec set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shard</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">mesh</span><span class="p">:</span> <span class="n">Mesh</span><span class="p">,</span>
    <span class="n">data_axis_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_shards</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">shard_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DataloaderBuilder[DatasetItem, Batch]&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the mesh and partition spec for the dataloader.</span>

<span class="sd">    This will distribute the dataloading across multiple nodes within the same</span>
<span class="sd">    distributed network. This is useful for training large models on multiple</span>
<span class="sd">    nodes. You can then load the data into multiple devices on each node and</span>
<span class="sd">    train the model in parallel.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from loadax import DataloaderBuilder, InMemoryDataset, Batcher</span>

<span class="sd">        dataset = InMemoryDataset([1, 2, 3, 4, 5])</span>
<span class="sd">        batcher = Batcher(lambda x: x)</span>
<span class="sd">        dataloader = DataloaderBuilder(batcher)</span>
<span class="sd">                            .batch_size(2)</span>
<span class="sd">                            .shard(mesh, data_axis_name=&#39;data&#39;)</span>
<span class="sd">                            .build(dataset)</span>
<span class="sd">        iterator = iter(dataloader)</span>
<span class="sd">        for batch in iterator:</span>
<span class="sd">            print(batch)</span>

<span class="sd">        #&gt; [1, 2]</span>
<span class="sd">        #&gt; [3, 4]</span>
<span class="sd">        #&gt; [5]</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        mesh (Mesh): The mesh to use for sharding.</span>
<span class="sd">        data_axis_name (str | None): The name of the data axis to use for sharding.</span>
<span class="sd">        num_shards (int): The number of shards to distribute the data across.</span>
<span class="sd">            If not specified, the dataloader will choose automatically using</span>
<span class="sd">            jax.process_count().</span>
<span class="sd">        shard_id (int): The ID of the shard to load the data from.</span>
<span class="sd">            If not specified, the dataloader will choose automatically using</span>
<span class="sd">            jax.process_index().</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataloader: The dataloader with the mesh and partition spec set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">num_shards</span> <span class="ow">and</span> <span class="n">num_shards</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sharding_strategy</span> <span class="o">=</span> <span class="n">NoShardingStrategy</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sharding_strategy</span> <span class="o">=</span> <span class="n">DistributedShardingStrategy</span><span class="p">(</span>
            <span class="n">mesh</span><span class="p">,</span> <span class="n">data_shard_axis</span><span class="o">=</span><span class="n">data_axis_name</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shard_id</span> <span class="o">=</span> <span class="n">shard_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_shards</span> <span class="o">=</span> <span class="n">num_shards</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="loadax.DataloaderBuilder.build" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">build</span>


<a href="#loadax.DataloaderBuilder.build" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataset.Dataset" href="../dataset/dataset/#loadax.dataset.protocol.Dataset">Dataset</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="loadax.dataloader.loader.Dataloader" href="../loader/#loadax.dataloader.Dataloader">Dataloader</a></span><span class="p">[</span><span class="n"><span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span></span><span class="p">,</span> <span class="n"><span title="loadax.dataloader.builder.Batch">Batch</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Construct the dataloader from the current configuration.</p>
<p>This method constructs the dataloader from the current configuration. The
dataloader is constructed based on the current configuration of the dataloader.
If the dataloader is not configured to use multiprocessing, it will use the
naive dataloader. If the dataloader is configured to use multiprocessing, it
will use the multiprocessing dataloader.</p>
<p>The default configuration of the dataloader is to use a fixed batch size of
1 and to use a single worker. This means that there is not parallelism in
loading the data, but the data will still be prefetched with 2 batches in
advance on the single worker. This is a good default configuration for most
use cases, unless you have a fast training loop and potentially many devices.</p>


<details class="example" open>
  <summary>Example</summary>
  <div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">loadax</span> <span class="kn">import</span> <span class="n">DataloaderBuilder</span><span class="p">,</span> <span class="n">InMemoryDataset</span><span class="p">,</span> <span class="n">Batcher</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">InMemoryDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">batcher</span> <span class="o">=</span> <span class="n">Batcher</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataloaderBuilder</span><span class="p">(</span><span class="n">batcher</span><span class="p">)</span><span class="o">.</span><span class="n">batch_size</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">workers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
<span class="n">iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">dataloader</span><span class="p">)</span>
<span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="c1">#&gt; [1, 2]</span>
<span class="c1">#&gt; [3, 4]</span>
<span class="c1">#&gt; [5]</span>
</code></pre></div>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>dataset</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataset.Dataset" href="../dataset/dataset/#loadax.dataset.protocol.Dataset">Dataset</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to load data from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataloader</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="loadax.dataloader.loader.Dataloader" href="../loader/#loadax.dataloader.Dataloader">Dataloader</a>[<span title="loadax.dataloader.builder.DatasetItem">DatasetItem</span>, <span title="loadax.dataloader.builder.Batch">Batch</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataloader constructed from the current configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/loadax/dataloader/builder.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">[</span><span class="n">DatasetItem</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dataloader</span><span class="p">[</span><span class="n">DatasetItem</span><span class="p">,</span> <span class="n">Batch</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the dataloader from the current configuration.</span>

<span class="sd">    This method constructs the dataloader from the current configuration. The</span>
<span class="sd">    dataloader is constructed based on the current configuration of the dataloader.</span>
<span class="sd">    If the dataloader is not configured to use multiprocessing, it will use the</span>
<span class="sd">    naive dataloader. If the dataloader is configured to use multiprocessing, it</span>
<span class="sd">    will use the multiprocessing dataloader.</span>

<span class="sd">    The default configuration of the dataloader is to use a fixed batch size of</span>
<span class="sd">    1 and to use a single worker. This means that there is not parallelism in</span>
<span class="sd">    loading the data, but the data will still be prefetched with 2 batches in</span>
<span class="sd">    advance on the single worker. This is a good default configuration for most</span>
<span class="sd">    use cases, unless you have a fast training loop and potentially many devices.</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        from loadax import DataloaderBuilder, InMemoryDataset, Batcher</span>

<span class="sd">        dataset = InMemoryDataset([1, 2, 3, 4, 5])</span>
<span class="sd">        batcher = Batcher(lambda x: x)</span>
<span class="sd">        dataloader = DataloaderBuilder(batcher).batch_size(2).workers(2).build(dataset)</span>
<span class="sd">        iterator = iter(dataloader)</span>
<span class="sd">        for batch in iterator:</span>
<span class="sd">            print(batch)</span>

<span class="sd">        #&gt; [1, 2]</span>
<span class="sd">        #&gt; [3, 4]</span>
<span class="sd">        #&gt; [5]</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (Dataset): The dataset to load data from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataloader: The dataloader constructed from the current configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">strategy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span> <span class="k">else</span> <span class="n">FixedBatchStrategy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Dataloader</span><span class="p">(</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">,</span>
        <span class="n">batcher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batcher</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">prefetch_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefetch_factor</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">sharding_strategy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sharding_strategy</span><span class="p">,</span>
        <span class="n">shard_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shard_id</span><span class="p">,</span>
        <span class="n">num_shards</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_shards</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                


              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "announce.dismiss", "navigation.tabs", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.top", "navigation.tracking", "navigation.sections", "navigation.expand", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>